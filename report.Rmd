---
output: html_document
params:
    file:
        value: x
    set_title:
        value: x
title: '`r params$set_title`'
author: "Hemberg Lab"
date: '`r strftime(Sys.time(), format = "%B %d, %Y")`'
---

```{r, include=FALSE}
library(knitr)
opts_chunk$set(fig.height = 6, fig.width = 6, fig.align = 'center', echo = FALSE)
library(scater)
d <- readRDS(paste0("scater-objects/", params$file))
```

## QC of library size and detected genes

```{r}
if(!is.null(d$total_counts) & !is.null(d$total_features)) {
    plotPhenoData(d, aes(x = total_counts, y = total_features,
                                  colour = cell_type1))
    plotPhenoData(d, aes(x = cell_type1, y = total_features,
                                  colour = log10_total_counts))
}
```

## QC of expression

```{r, message=FALSE, warning=FALSE}
if(!is.null(d$total_counts) & !is.null(d$total_features)) {
    plotQC(d, type = "highest-expression")
    plotQC(d, type = "exprs-freq-vs-mean")
}
```

## QC of experimental variables
```{r, message=FALSE, warning=FALSE}
plotQC(d, type = "expl",
       variables = c("total_features", "total_counts", "cell_type1"))
```

## PCA plot
```{r}
plotPCA(d, colour_by = "cell_type1")
```
